{% extends 'base.html' %}
{% block css %}
    <style>
        #theButtonContainer {
            margin-top: 10px;
        }
    </style>
{% endblock %}

{% block content %}
    {% include 'navBar.html' %}
    <div class="row">
        <div class="col s8">

            <h4><a href="">{{ user }} </a>/<a
                    href="{% url 'detail_repo' owner=repo.owner name=repo.name %}">{{ repo.name }}</a></h4>
            <!-- Modal Trigger -->
            <a class="waves-effect waves-light btn modal-trigger" href="#modal1">Delete Repository</a>

        </div>
        <div class="col s4">
            <div id="theButtonContainer" class="container">
                <div class="row">
                    <div class="col right" id="star-section">
                        {% include 'Repos/star-section.html' %}
                    </div>
                    <a class="col right" href="{% url 'profile' user %}">
                        <button class="btn purple lighten-1" type="submit">Profile</button>
                    </a>
                    <a class="col right" href="{% url 'profile' user %}">
                        <button class="btn purple lighten-1" type="submit">Watch</button>
                    </a>

                    {% if repo.parent %}
                        <p>This repo is forked from</p>
                        <a class="waves-effect waves-light modal-trigger"
                           href="{% url 'detail_repo' owner=repo.parent.owner name=repo.name %}">{{ repo.parent.owner }}/{{ repo.name }}/</a>
                    {% endif %}
                    {% if repo.owner != request.user %}
                        <a class="waves-effect waves-light btn modal-trigger" href="{% url 'fork' repo.pk %}">Fork
                            Repository</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col s8">
            <div class="row">
                <div class="col s10 offset-s2">

                    <div class="row">
                        <div class="col s12">
                            <div class="card-panel teal">
        <span class="white-text">I am a very simple card. I am good at containing small bits of information.
        I am convenient because I require little markup to use effectively. I am similar to what is called a panel in other frameworks.
        </span>
                            </div>
                            <div class="card-panel purple">
        <span class="white-text">I am a very simple card. I am good at containing small bits of information.
        I am convenient because I require little markup to use effectively. I am similar to what is called a panel in other frameworks.
        </span>
                            </div>
                        </div>
                        <div id="body" class="col s12">
                            <div class="collection">
                                {% for item in contents %}
{#                                    <li class="collection-item">#}
{#                                        <div>Alvin<a href="#!" class="secondary-content"><i#}
{#                                                class="material-icons">send</i></a>#}
{#                                        </div>#}
{#                                    </li>#}
                                    <li class="collection-item">
                                        <div class="secondary-content left">
                                            <i class=" material-icons ">folder</i><a
                                                href="#!"> {{ item }}</a>
                                        </div>
                                        <div class="center-align">First Commit</div>
                                       <div class="right-align">69 days ago</div>

                                    </li>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col s4 " style="background-color:red;">

        </div>
    </div>
    <!-- Modal Structure -->
    <div id="modal1" class="modal">
        <div class="modal-content">
            <h4>Delete Repository</h4>
            <p>Once deleted you can not undo it</p>
            <p>Type "{{ repo.owner }}/{{ repo.name }}/" to confirm delete</p>
            <input type="text" placeholder="Type here" id="delete_box">
        </div>
        <div class="modal-footer">
            <a href="{% url 'delete_repo' owner=repo.owner name=repo.name %}">
                <button class="btn" disabled="disabled" id="delete_btn"> Delete</button>
            </a>
        </div>
    </div>


{% endblock %}

{% block script %}
    <script>
        $(document).ready(function () {
            $('.modal').modal();
        });
    </script>
    <script>
        $(document).ready(function () {
            $('#delete_box').keyup(function () {
                var btnSubmit = $("#delete_btn");
                var text = "{{ repo.owner }}/{{ repo.name }}/";
                if ($(this).val() === text) {
                    btnSubmit.removeAttr("disabled");
                } else {
                    btnSubmit.attr("disabled", "disabled");
                }
            })
        });
    </script>
    <script>
        $(document).ready(function () {
            $(document).on('click', '#starbtn', function (event) {
                event.preventDefault()
                var iid = {{ repo.pk }}
                    $.ajax({
                        url: '{% url "star" %}',
                        type: 'post',
                        data: {
                            csrfmiddlewaretoken: "{{csrf_token}}",
                            id: iid,
                        },
                        success: function (data) {
                            $('#star-section').html(data['html'])
                        },
                        error: function (data) {
                            $("#errorToast").toast("show");
                        }
                    })
            })
        })
    </script>
{% endblock %}